package Cal_public_transit.Subway.section

import org.apache.spark.rdd.RDD

/**
  * Created by WJ on 2018/1/2.
  */
object LineFlowCounter {
  def getLineCounter(data:RDD[String]) ={
    data.flatMap(flatLine).countByValue().map(x=>x._1+","+x._2.toString)
  }

  def flatLine(x:String)={
    val L = x.split(",")
    val path = L.slice(7,L.size)
    val getLinePaht = scala.collection.mutable.ArrayBuffer[String]()
    var start = path(0)
    val stop = path(path.size-3)
    var tempTime = path(2)
    getLinePaht += start
    for (i <- 0 until path.size if (i % 4 == 0)){
      if(path(i+2) != tempTime) { start=path(i) ; getLinePaht += start}
      tempTime = path(i+3)
    }
    getLinePaht += stop
    val getStation = getLinePaht.toArray
    val getOd = for{
      i<- 0 until getStation.size-1
      od = getStation(i)+","+getStation(i+1)
    } yield od
    val transfers = "1261004000,1268012000,1268009000,1268021000,1261011000,1268003000,1260025000,1268018000,1268028000,1260034000,1268016000,1260029000,1268004000,1268019000,1267025000,1268030000,1263037000,1261018000,1261006000,1261015000,1263020000,1261009000,1263035000,1260019000,1262016000,1241013000,1268008000"
      .split(",")
    getOd
  }
  def findLine(od:String)={
    val line2 = "1260011000\n1260012000\n1260013000\n1260014000\n1260015000\n1260016000\n1260017000\n1260018000\n1260019000\n1260020000\n1260021000\n1260023000\n1260024000\n1260025000\n1260026000\n1260027000\n1260028000\n1260029000\n1260030000\n1260033000\n1260034000\n1260035000\n1260037000\n1260039000\n1268016000\n1261006000\n1268019000\n1268004000\n1263037000\n二号线".split("\n")
    val line1 = "1268001000\n1268002000\n1268003000\n1268004000\n1268005000\n1268006000\n1268007000\n1268008000\n1268009000\n1268011000\n1268012000\n1268013000\n1268014000\n1268015000\n1268016000\n1268022000\n1268023000\n1268024000\n1268025000\n1268026000\n1268027000\n1268028000\n1268029000\n1268030000\n1268031000\n1268032000\n1268033000\n1268034000\n1268035000\n1268036000\n一号线".split("\n")
    val line3 = "1261003000\n1261004000\n1261006000\n1261008000\n1261009000\n1261010000\n1261011000\n1261013000\n1261014000\n1261015000\n1261016000\n1261017000\n1261018000\n1261019000\n1261020000\n1261021000\n1261022000\n1261023000\n1261024000\n1261025000\n1261026000\n1261027000\n1261028000\n1261029000\n1261030000\n1261031000\n1261032000\n1268009000\n1268021000\n1268003000\n三号线".split("\n")
    val line4 = "1262011000\n1262012000\n1262013000\n1262014000\n1262015000\n1262016000\n1262017000\n1262018000\n1262019000\n1262020000\n1268017000\n1268018000\n1268019000\n1268021000\n1267022000\n1268008000\n四号线".split("\n")
    val line5 = "1263012000\n1263013000\n1263015000\n1263016000\n1263017000\n1263018000\n1263019000\n1263020000\n1263021000\n1263022000\n1263023000\n1263025000\n1263026000\n1263027000\n1263028000\n1263029000\n1263030000\n1263031000\n1263033000\n1263034000\n1263035000\n1263036000\n1263037000\n1268028000\n1268030000\n1262016000\n1261018000\n五号线".split("\n")
    val line7 = "1265011000\n1265013000\n1265014000\n1265015000\n1265016000\n1265017000\n1265019000\n1265021000\n1265022000\n1265024000\n1265026000\n1265027000\n1265028000\n1265029000\n1265032000\n1265033000\n1267025000\n1265035000\n1265036000\n1263020000\n1260025000\n1268012000\n1261004000\n1268018000\n1260034000\n1261009000\n1261015000\n1263035000\n七号线".split("\n")
    val line9 = ""
    val line11 = ""
  }

  def main(args: Array[String]): Unit = {
    flatLine("323331909,1261020000,06:31:30,1262016000,07:04:09,1959,1623 ,1261020000,1261019000,06:59:47,07:01:58,1261019000,1261018000,07:01:58,07:04:14,1261018000,1263031000,07:06:40,07:08:52,1263031000,1263030000,07:08:52,07:10:44,1263030000,1263029000,07:10:44,07:12:39,1263029000,1263028000,07:12:39,07:15:59,1263028000,1263027000,07:15:59,07:17:54,1263027000,1263026000,07:17:54,07:20:07,1263026000,1263025000,07:20:07,07:23:27,1263025000,1262016000,07:23:27,07:25:46")
      .foreach(println)
  }

}
